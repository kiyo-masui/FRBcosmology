%\documentclass[onecolumn,amsmath,amssymb,floatfix,12pt,nofootinbib]{revtex4}
\documentclass[twocolumn,prd,noshowpacs,nofootinbib,amsmath,amssymb]{revtex4}
\usepackage{graphicx,epsfig,psfrag,bm,amssymb}
\usepackage{dcolumn}
\usepackage{bm}
\usepackage{mciteplus}
\usepackage{color}
\usepackage{mathrsfs,amsfonts,hepunits, color}
\usepackage{mciteplus}
\usepackage{tikz}
\usepackage{slashed}
\usepackage{verbatim}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{trees}
\usetikzlibrary{matrix,arrows} 				% For commutative diagram
											% http://www.felixl.de/commu.pdf
\usetikzlibrary{positioning}				% For "above of=" commands
\usetikzlibrary{calc,through}				% For coordinates
\usetikzlibrary{decorations.pathreplacing}  % For curly braces
\usepackage{pgffor}							% For repeating patterns

\usetikzlibrary{decorations.pathmorphing}	% For Feynman Diagrams
\usetikzlibrary{decorations.markings}
\usetikzlibrary{snakes}

\tikzset{
	% >=stealth', %%  Uncomment for more conventional arrows
    vector/.style={decorate, decoration={snake}, draw},
	provector/.style={decorate, decoration={snake,amplitude=2.5pt}, draw},
	antivector/.style={decorate, decoration={snake,amplitude=-2.5pt}, draw},
    fermion/.style={draw, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw]{>}}}},
    fermionbar/.style={draw, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw=black]{<}}}},
    fermionnoarrow/.style={draw},
    gluon/.style={decorate, draw,decoration={coil,amplitude=4pt, segment length=6pt}, line width=1},
    scalar/.style={dashed,draw, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw]{>}}}},
    scalarbar/.style={dashed,draw, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw]{<}}}},
    scalarnoarrow/.style={dash pattern = on 6 pt off 3 pt,draw},
    electron/.style={draw, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw]{>}}}},
	bigvector/.style={decorate, decoration={snake,amplitude=4pt}, draw},
	vectorscalar/.style={loosely dotted,draw, postaction={decorate}},
}
\RequirePackage{xspace}
\usepackage{relsize}
\usepackage{slashed}
\newcommand{\fb}{{\rm fb}}
\newcommand{\ab}{{\rm ab}}

\newcommand{\be}{\begin{eqnarray}}
\newcommand{\ee}{\end{eqnarray}}
\def\lsim{\mathrel{\rlap{\lower4pt\hbox{\hskip 0.5 pt$\sim$}}
    \raise1pt\hbox{$<$}}}                % less than or approx. symbol
\def\gsim{\mathrel{\rlap{\lower4pt\hbox{\hskip1pt$\sim$}}
    \raise1pt\hbox{$>$}}} 

\newcommand{\schi}{s_{\chi\bar\chi}}  % tried to use this throughout off-shell derivation so that we can change notation later if desired.
\newcommand{\scratch}[1]{{\textcolor{red}{ #1}}}
\newcommand{\f}{\frac}
\newcommand{\pf}[2]{\left(\frac{#1}{#2}\right)}
\newcommand{\g}{{\rm g}}
\newcommand{\s}{{\rm s}}
\newcommand{\m}{{\rm m}}
\def\lsim{\mathrel{\rlap{\lower4pt\hbox{\hskip1pt$\sim$}}
    \raise1pt\hbox{$<$}}}
\def\gsim{\mathrel{\rlap{\lower4pt\hbox{\hskip1pt$\sim$}}
    \raise1pt\hbox{$>$}}}
\newcommand{\vev}[1]{ \left\langle {#1} \right\rangle }
\newcommand{\bra}[1]{ \langle {#1} | }
\newcommand{\ket}[1]{ | {#1} \rangle }
\newcommand{\ev}{ {\rm eV} }
\newcommand{\kev}{{\rm keV}}
\newcommand{\mev}{{\rm MeV}}
\newcommand{\gev}{{\rm GeV}}
\newcommand{\tev}{{\rm TeV}}
\newcommand{\mpl}{$M_{Pl}$}
\newcommand{\mw}{$M_{W}$}
\newcommand{\Ft}{F_{T}}
\newcommand{\Zparity}{\mathbb{Z}_2}
\newcommand{\BLambda}{\boldsymbol{\lambda}}


% shortcuts
\newcommand{\ud}{\,\mathrm{d}}
\newcommand{\bD}{\boldsymbol D}
\newcommand{\bC}{\boldsymbol C}
\newcommand{\bDelta}{\boldsymbol \Delta}

% for draft comments.
\newcommand{\red}{\textcolor{red}}
\newcommand{\blue}{\textcolor{blue}}
\newcommand{\green}{\textcolor{green}}



\begin{document}

\title{Fast Radio Burst Cosmology}

\author{Kris Sigurdson}
 \affiliation{Department of Physics and Astronomy, University of British 
Columbia, Vancouver, BC, Canada V6T 1Z1}

\author{Kiyoshi Wesley Masui}
 \affiliation{Department of Physics and Astronomy, University of British 
Columbia, Vancouver, BC, Canada V6T 1Z1}



\begin{abstract}
In recent years a new astrophysical phenomena, fast radio bursts (FRBs), has been detected that potentially originates from cosmological distances.  These broadband radio bursts  typically last for only milliseconds and are a \emph{standard ping} that can be used to map the properties of the Universe.  In this paper,  under the assumption that these bursts originate from cosmological distances, we discuss how the detection of a large enough population of these events can be used to map the cosmological properties of the Universe.    We first discuss one point statistics and show that, even if FRBs are not standard candles, the dispersion-measure distance vs. luminosity-distance distribution of any observed population is a strong constraint on cosmology.  We then discuss how the two point statistics of an observed population of FRBs traces the large-scale structure of the Universe and make predictions for the angular power spectra of dispersion-measure distance.  It is possible that FRBs do not originate at cosmological distances, but if they do, we argue that they could open a remarkable window to observe the properties of the Universe.
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%					Introduction
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}
Several years ago an unusual radio event was discovered at the Parks radio telescope while searching for millisecond pulsars.  In a direction out of the plane of the Galaxy an event was discovered with an unusually large dispersion-measure, implying a column of electrons much large than expected in the Galaxy.

In this \emph{ Letter} we consider the implications of of a cosmological population of fast radio bursts (FRBs). 
 If FRBs originate at cosmological distances they provide a new window on the Universe. The key insight into the potential power of FRBs is that, while it is interesting and helpful to know the redshift of the burst, it is not necessary to do interesting studies of cosmology.
 
 The outline of this \emph{Letter} is as follows. In Section \ref{sec:notes} we discuss how dispersion measure provides a new distance measure in cosmology and how the joint distribution of dispersion-distance and luminosity-distance of a population of FRBs depends on cosmology and the intrinsic luminosity distance distribution.   In Section \ref{sec:notes} we then show how to calculate the angular power spectra of dispersion distance.  We then forecast how well these cosmological observables can be measured.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%					Basic Ingredients 
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Notes}\label{sec:notes}

\subsection{Dispersion measure}

%Let's define the dispersion-measure distance.

%The lets discuss how a given luminosity relationship and cosmology dictates an expected joint distribution of dispersion measure.

The dispersion measure of a FRB observed in some angular direction $\hat{n}$ and
originating from redshift $z$ is
\begin{equation}
    {\rm DM}(\hat{n}, z) = \int_0^{\eta(z)} d\eta'
        \frac{n_e(\hat{n}, z')}{(1+z')^2}.
\end{equation}
Here, $\eta$ is the conformal distance as a function of redshift, and
$n_e(\hat{n}, z)$ is the three dimensional electron density.  We choose to
separate $n_e$ into four components as follows:
\begin{equation}
\label{e:ne_sep}
n_e(\hat{n}, z) = n_e^{\rm gal}(\hat{n}, z) + \bar{n}_e(z) +
    \bar{n}_e(z)\delta_e(\hat{n}, z) + n_e^{\rm src}(\hat{n}, z).
\end{equation}
Here $n_e^{\rm gal}(\hat{n}, z)$ is the contribution to the electron density
from the Milky Way galaxy and other local structures and only contributes at
low redshift. $\bar{n}_e(z)$ is the mean electron density is and related to the
current day electron density by $\bar{n}_e = \bar{n}_{e0} (1+z)^3$. 
$\delta_e(z,\hat{n})$ is the large-scale fractional over-density of electrons.
$n_e^{\rm src}(\hat{n}, z)$ are the electrons associated with the FRB source,
which only contributes as $z \approx z^{\rm src}$ and accounts for two effects.
First the FRB itself
may have some intrinsic dispersion measure due to the environment of the
progenitor.  Second, it is unlikely that FRB events are uniformly distributed
throughout the Universe and they presumably trace matter in some way. When
considering statics of FRB dispersion measures it is necessary to account for
this bias.

We define the dispersion-measure distance (or dispersion distance),
the equivalent distance required to
produce a given amount of dispersion in an observed radio signal in the
Universe today, as $ D = {{\rm DM}}/{\bar{n}_{e0}}$
We separate the dispersion distance into the contributions from each
term in \ref{e:ne_sep}:
\begin{equation}
\label{e:D_sep}
D = D^{\rm gal} + D^{\bar{n}_e} + D^{\delta_e} + D^{\rm src}.
\end{equation}
For a population of FRBs originating at cosmological distances, ${\rm DM}^{\rm
src}$ is only a single function of $\hat{n}$ which can presumably be well
measured.  In addition, this function could in principal be well characterized
by independent data such as observations of pulsars.  As such, we will
here-after we ignore this term.

We are principally interested in the $D^{\delta_e}$ term as it is a probe of
large-scale structure. In the next section we relate the statistics of this
term to cosmology.


\subsection{Relating dispersion measure angular power-spectrum to cosmology}

The angular correlation function of dispersion distance between two lines of sight at redshift $z$ and direction $\hat{n}$ and redshift $z'$ and direction $\hat{n}'$ is
\begin{equation}
w^{z z'}(\hat{n}\cdot\hat{n}') = \langle D^{\delta_e}(\hat{n}, z) D^{\delta_e}(\hat{n}', z') \rangle
\end{equation}
and the corresponding angular power spectrum is
\begin{equation}
w^{z z'}(\hat{n}\cdot\hat{n}') = \sum_l \frac{2l+1}{4 \pi} C_l^{z z'} P_l(\hat{n}\cdot\hat{n}')
\end{equation}

We can decompose the dispersion-distance field into spherical harmonics as
\begin{equation}
    D^{\delta_e}(\hat{n}, z) = \sum_{l m} D^{\delta_e}_{l m}(z) Y_{l m} (\hat{n})
\end{equation}

A plane wave can be expanded in terms of spherical eigenfunctions using the Rayleigh expansion
\begin{equation}
e^{i \vec{k}\cdot \hat{n} \eta} = 4\pi \sum_{l m} i^l j_{l}(k\eta) Y^*_{lm}(\hat{k})Y_{lm}(\hat{n})
\end{equation}
If we define 
\begin{equation}
n_e(\vec{k}) = \int d^3 \vec{x} e^{-i \vec{x}\cdot\vec{k}} n_e(\vec{x})
\end{equation}
to be the Fourier transform of the comoving electron density field then we can write
\begin{equation}
    D^{\delta_e}_{l m}(z) = \frac{4 \pi i^{l}}{\bar{n}_{e0}} \int \frac{d^3
    \vec{k}}{(2\pi)^3} n_e(\vec{k}) Y^*_{l m}(\hat{k}) \int_0^{\eta^z} d\eta a^{-1}(\eta) j_{l}(k\eta)
\end{equation}
and the angular power spectra of dispersion-distance, assumed to be an isotropic random field, is thus
\begin{equation}
    \langle D^{\delta_e}_{l m}(z) D^{\delta_e}_{l' m'}(z') \rangle = C_l^{z z'} \delta_{l l'} \delta_{m m'}
\end{equation}
Now since we have 
\begin{equation}
\langle n_e(\vec{k}) n_e(\vec{k}')\rangle = \bar{n}_{e0}^2\left[\langle \delta_e(\vec{k})\delta_e(\vec{k}')\rangle + 1 \right]
\end{equation}
where
\begin{equation}
\langle \delta_e(\vec{k})\delta_e(\vec{k}')\rangle = (2\pi)^3 \delta_{D}^3(\vec{k}-\vec{k}') P_{ee}(k)
\end{equation}
we finally have
\begin{equation}
C_l^{zz'}=\frac{2}{\pi} \int_0^{\infty}k^2 dk P_{ee}(k) \int_0^{\eta^z}\frac{d\eta}{a(\eta)} \int_0^{\eta^{z'}}\frac{d\eta'}{a(\eta')}  j_l(k\eta) j_l(k\eta')
\end{equation}
The one-point variance in the dispersion-distance from a redshift $z$ is just
\begin{equation}
(\sigma^2)^{zz}=\sum_{l} \frac{2l+1}{4\pi} C_l^{zz}
\end{equation}
Using the addition identify for a complete sum over spherical bessel functions we find that
\begin{equation}
(\sigma^2)^{zz}= \frac{1}{2\pi^2} \int_0^{\infty}k^2 dk P_{ee}(k) \int_0^{\eta^z}\frac{d\eta}{a(\eta)} \int_0^{\eta^{z}}\frac{d\eta'}{a(\eta')}  j_0(k\eta-k\eta')
\end{equation}


Given a source-population redshift distribution ${\cal P}(\eta^z)$, where 
\begin{equation}
\int d\eta^z {\cal P}(\eta^z) = 1
\end{equation}

The observable power spectrum of mean dispersion distance $\bar{D}$ is then
\begin{equation}
C_l^{\bar{D}\bar{D}} = \int d\eta^z \int d\eta^{z'} {\cal P}(\eta^z){\cal P}(\eta^{z'}) C_l^{z z'}
\end{equation}

We use the halo model to calculate $P_{ee}(k)$ and a potential ${\cal P}(z)$.



\subsection{Estimating the DM angular power spectrum from a sample of observed
FRBs}

To relate observations to cosmology, we wish to determine how a set of observed
dispersion measures $\boldsymbol D$ (whose members are $D_i$)
with known angular positions, $\hat n_i$, but with unknown
redshifts, $z_i$, depends on cosmological parameters.  We begin by defining the
redshift probability distribution function $p(\boldsymbol z)$. We assume that the
redshifts of the FRB sources are independent, \emph{i.e.}~we assume
\begin{equation}
    p(\boldsymbol z) = \prod_i p(z_i).
\end{equation}
This may not be strictly true since FRBs are expected to cluster and trace the
large-scale structure. This is a potential source of bias in the estimator we
derive.  From this assumption it follows that the $D^{\bar{n}_e}_i$ have
uncorrelated probability distributions
\begin{align}
    p(D^{\bar{n}_e}_i)
    &= p(z_i) \left|\frac{\ud D^{\bar{n}_e}}{\ud z} \right|_{z_i}^{-1} \\
        &= p(z_i) \left(\frac{\ud \eta}{\ud z} \right)_{z_i}^{-1},
\end{align}
whose second moment is
\begin{align}
    \langle D^{\bar{n}_e}_i D^{\bar{n}_e}_j \rangle
        &- \langle D^{\bar{n}_e}_i \rangle \langle D^{\bar{n}_e}_j \rangle \\
        &= \delta_{ij} \left[ \int_0^\infty \ud D^{\bar{n}_e} (D^{\bar{n}_e})^2
            p(D^{\bar{n}_e})
            - \left( \int_0^\infty \ud D^{\bar{n}_e} D^{\bar{n}_e}
        p(D^{\bar{n}_e}) \right)^2 \right]\\
        &\equiv \delta_{ij} \sigma_{\bar{n}_e}^2\\
\end{align}

We further assume that $D^{\rm src}_i$ are uncorrelated. Again this may not
be strictly true due to clustering of FRB sources and again this may bias our
estimator. We parameterized the variance from this term as 
\begin{equation}
    \langle D^{\rm src}_i D^{\rm src}_j \rangle
    - \langle D^{\rm src}_i \rangle \langle D^{\rm src}_j \rangle
    = \delta_{ij} \sigma^2_{\rm src}.
\end{equation}

The cosmological information lies in the correlations between the
$D^{\delta_e}_i$. If the redshifts of the observed FRBs where known, we
would write the probability density function of this set as
$p(\boldsymbol D^{\delta_e} | \boldsymbol z)$, which has second moments
\begin{equation}
    w^{z_i z_j}(\hat{n}_i\cdot\hat{n}_j) \equiv \int \ud \boldsymbol D^{\delta_e}
        D^{\delta_e}_i D^{\delta_e}_j p(\boldsymbol D^{\delta_e} | \boldsymbol z).
\end{equation}
$w^{z_i z_j}(\hat{n}_i\cdot\hat{n}_j)$ is the redshift dependant DM angular
correlation function, whose dependence on cosmology is derived below.
Marginalizing $p(\boldsymbol D^{\delta_e} | \boldsymbol z)$ over the unknown redshifts
yields
\begin{equation}
    p(\boldsymbol D^{\delta_e}) = \int_0^\infty \ud \boldsymbol z
        p(\boldsymbol z) p(\boldsymbol D^{\delta_e} | \boldsymbol z).
\end{equation}
The second moment of the marginalized distribution is
\begin{align}
    \langle D^{\delta_e}_i D^{\delta_e}_j \rangle =& \\
        =& \textrm{stuff} \\
        =&
        \begin{cases}
            \int \ud z \ud z' p(z) p(z') w^{z z'}(\hat{n}_i\cdot\hat{n}_j) 
                &  \text{if } (i \neq j) \\
            \int \ud z \ud z' \delta(z - z') p(z) w^{z z'}(\hat{n}_i\cdot\hat{n}_j)
                &  \text{if } (i = j)
        \end{cases}
\end{align}

The covariance matrix is
\begin{align}
    C_{ij} \equiv& \langle D_i D_j \rangle - \langle D_i \rangle \langle D_j
    \rangle\\
    =&
        \begin{cases}
            \sum_l \frac{2l+1}{4 \pi} C_l P_l(\hat{n}_i\cdot\hat{n}_j)
                &  \text{if } (i \neq j) \\
            \sigma_{\bar{n}_e}^2 + \sigma^2_{\rm src}
                + \textrm{(the $w$ term)}
                &  \text{if } (i = j)
        \end{cases}
\end{align}

\red{The cosmological term is probably negligible for the diagonal elements.}

We have written the covariance matrix in terms of $C_l$, the
redshift distribution function for FRBs, $p(z)$, and the unknown parameter
$\sigma^2_{\rm src}$.  This will enable us to construct a quadratic estimator
for a desired set of cosmological parameters from the observed set of
dispersion measures.

Now that we have the covariance matrix, we construct a quadratic estimator
($\hat{\lambda}_\alpha$) for
chosen parameters $\lambda_\alpha$. The estimator is Equation~11.94 from
Dodelson, although we have to modify it slightly to exclude the
auto-correlations.  The error (assuming Gaussianity) is Equation~11.100.

Defining data vector $\bDelta = \bD - \bar{D}$ where $\bar{D}$ is the sample
mean of dispersion measures.

\begin{equation}
    \hat{\lambda}_\alpha = \lambda_0
    + \frac{F^{-1}_{\alpha\beta}}{2} 
    \left[ \bDelta^T \bC^{-1} \bC_{,\beta} \bC^{-1} \bDelta
    - \mathrm{Tr}\left[\bC^{-1} \bC_{,\beta}\right] \right],
\end{equation}
for some fiducial value of the parameter $\lambda_0$.  $F_{\alpha\beta}$ is the
Fisher matrix, given by
\begin{equation}
    F_{\alpha \beta} = \frac{1}{2} \mathrm{Tr} 
        \left[ \bC_{,\alpha} \bC^{-1} \bC_{,\beta} \bC^{-1} \right]
\end{equation}

The covariance of this estimator (assuming Gaussianity of the original
data) is
\begin{equation}
    \langle \lambda_\alpha \lambda_\beta \rangle
        - \langle \lambda_\alpha \rangle \langle \lambda_\beta \rangle
        = F^{-1}_{\alpha\beta}
\end{equation}

The dispersion measure angular correlation function 
$w(\hat{n}_i\cdot\hat{n}_j)$ depends on the cosmology
and the redshift distribution function $p(z)$, for which we may parameterize
our ignorance. The
cross-correlations between the observed dispersion measures are thus useful
probes of cosmology.  The auto-correlations on the other hand are contaminated
by the highly uncertain $\sigma^2_{\rm src}$ as well as the $C^{zz'}_\ell$ on
very small scales and zero redshift separation, which is difficult to model
theoretically.  As such they do not carry useful information.

To explicitly ignore the information in the auto-correlations we define
\begin{equation}
    \tilde{C}_{ij,\alpha} \equiv
\begin{cases}
    C_{ij,\alpha} & \text{if } i \neq j,\\
0 & \text{if } i = j
\end{cases}.
\end{equation}
By replacing $C_{ij,\alpha}$ with this quantity in the above estimator, we
obtain an estimator which explicitly excludes information in the auto-products
and only uses the diagonal of the covariance in the noise weights. Our
ignorance of $\sigma^2_{\rm src}$ then only affects the optimality of the
estimator, although in practise
$\langle D_i D_i \rangle - \langle D_i \rangle \langle D_i \rangle$ would
simply be measured directly from the data to obtain accurate noise weights.

%We further assume that the terms in Equation \ref{e:D_sep} are mutually uncorrelated


\begin{comment}
is the dispersion-measure random field in angular direction $\hat{n}$ where
\begin{equation}
n_e(\eta^z\hat{n}) \equiv n_e(z,\hat{n}) =  \bar{n}_{e0} (1+z)^3 \left[1+\delta_e(z,\hat{n})\right]
\end{equation}
is the electron distribution of the Universe and $\bar{n}_{e0}$ is the mean cosmological density of free electrons today, and $\delta_e(z,\hat{n})$ is 
the fractional over-density of electrons.
\end{comment}



\section{Sensitivity}

In this section we calculate the sensitivity of a hypothetical survey observing
X FRBs. Because $C_\ell$ contains the all the information we use bins
of $C_\ell$ as our parameters. We use the error bar on these parameters given
in Equation~\ref{e:error}.  We note that it is highly unlikely that an observed
set $\{D_i\}$ is even remotely Gaussian, and as such our error-bars are likely
underestimated and out estimator sub-optimal at the order unity level. 
However since given that the statistics of FRBs are currently essentially
unconstrained, we continue with this assumption.

We assume parameters X, Y, Z etc.



\bigskip
\section*{Acknowledgments}
\medskip

 
\bibliographystyle{apsrevM}
\bibliography{BBD-Draft}

\end{document}



